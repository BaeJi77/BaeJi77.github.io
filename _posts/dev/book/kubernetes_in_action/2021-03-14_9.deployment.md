---
title: "[Kubernetes in action] chapter 9. Deployment"

categories:
  - dev
  - book
tags:
  - dev
  - book
  - kubernetes in action
---

# 서론
- 파드를 최신 버전으로 교체
- 관리되는 파드 업데이트
- 이플로이먼트 리소스로 파드의 선언적 업데이트
- 롤링 업데이트 수행
- 잘못된 버전의 롤아웃 자동 차단
- 롤아웃 속도 제어
- 이전 버전으로 파드 되돌리기

애플리케이션은 변경될 것이다. 쿠버네티스트에서 실행되는 애플리케이션을 업데이트하는 방법과 무중단 업데이트를 어떻게 하는지 설명할 것이다.

이 작업은 레플리케이션 컨트롤러 또는 레플리카셋을 사용해서 수행할 수 있지만 디플로이는 레플리카셋 기능을 활용해서 선언적으로 업데이트를 가능하게 한다.

# 파드에서 실행중인 애플리케이션 업데이트

기본 버전 v1을 태그로 가지는 애플리케이션을 외부에서 접근할 수 있다. 그런 상태에서 우리는 새로운 버전인 v2를 배포하고 싶다. 그러기 위해서는 우리는 기존 파드를 삭제하고 새로운 파드를 실행해야한다. 두가지 방법이 있다고 할 수 있다.

1. 기존 파드를 한번에 모두 삭제한 다음 새 파드를 실행
2. 새로운 파드를 실행하고 기존 파드를 삭제. 새로운 파드를 모두 띄우고 삭제하거나 그 중간 중간에 삭제와 배포를 같이 한다.

두가지 모두 장단점이 있다. 첫번째 같은 경우 일시적으로 서비스 접근이 불가능하다. 두번째 같은 경우 두가지 버전이 동시에 실행되어야 하기 때문에 서비스가 같은 기능을 제공하지 못할수도 있으며 데이터 저장소 같은 경우 새 버전이 이전 버전을 손상 시킬 수 있어서 데이터 스키마나 데이터 수정을 해서는 안된다.





